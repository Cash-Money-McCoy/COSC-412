var firebaseConfig={apiKey:"AIzaSyAcqojqKHjzr0qB6Lv4GHgcps0fZ-0Fgbo",authDomain:"cosc-412.firebaseapp.com",databaseURL:"https://cosc-412.firebaseio.com",projectId:"cosc-412",storageBucket:"cosc-412.appspot.com",messagingSenderId:"181251574498",appId:"1:181251574498:web:ee0f28fed7b08fcc"};firebase.initializeApp(firebaseConfig);const ui=new firebaseui.auth.AuthUI(firebase.auth());ui.start("#firebaseui-auth-container",{signInOptions:[{provider:firebase.auth.GoogleAuthProvider.PROVIDER_ID,scopes:["https://www.googleapis.com/auth/contacts.readonly"],customParameters:{prompt:"select_account"}},{provider:firebase.auth.FacebookAuthProvider.PROVIDER_ID,scopes:["public_profile","email","user_likes","user_friends"],customParameters:{auth_type:"reauthenticate"}},firebase.auth.TwitterAuthProvider.PROVIDER_ID,firebase.auth.EmailAuthProvider.PROVIDER_ID]});var version="v4",limit=5,count=0,trueData=4,flag=!0,articles=[],totalData=0;function producer(){if(console.log(count,trueData),count===trueData&&flag){for(var e in articles)createArticle(articles[e].id,articles[e].published,articles[e].data);flag=!1}}function showError(e){var t=document.createElement("div");t.innerHTML=e.message,document.getElementById("content").appendChild(t)}function createArticle(e,t,a){console.log(a);new FileReader;var r=document.createElement("div");r.className="card mb-4";var i=document.createElement("div");i.className="card-body",r.appendChild(i);var o=document.createElement("div");o.className="row",i.appendChild(o);var c=document.createElement("div");c.className="col-lg-6",o.appendChild(c);var n=document.createElement("img");n.className="img-fluid rounded",c.appendChild(n);var s=document.createElement("div");s.className="col-lg-6",o.appendChild(s);var l=document.createElement("h2");l.className="card-title",s.appendChild(l);var d=document.createElement("p");d.className="card-text",s.appendChild(d);var u=document.createElement("div");u.className="card-footer text-muted",r.appendChild(u),l.innerHTML=a.title,n.src=a.img,d.innerHTML=a.body,u.innerHTML="Posted on: "+new Date(t)+" by : "+a.uid,document.getElementById("content").appendChild(r)}firebase.database().ref("/"+version+"/article_group/article_list").orderByChild("published").limitToLast(limit).startAt(1).on("child_added",function(e){firebase.database().ref("/"+version+"/article_group/article/"+e.key).on("value",function(t){count++,articles.push({id:e.key,published:e.val().published,data:t.val()}),articles.sort(function(e,t){return console.log(e.published),e.published<t.published}),producer()},function(e){count++,showError(e),producer()})},function(e){alert(e)});var imgData,submitButton=document.querySelector("#submit-button"),titleText=document.querySelector("#title"),bodyText=document.querySelector("#body");function encodeImageFileAsURL(){var e=document.getElementById("inputFileToLoad").files;if(e.length>0){var t=e[0];console.log(e);var a=new FileReader;a.onload=function(e){imgData=e.target.result,document.querySelector("img").src=imgData},a.readAsDataURL(t)}}submitButton.addEventListener("click",function(){if(null!=firebase.auth().currentUser){var e=titleText.value,t=bodyText.value,a=firebase.auth().currentUser.displayName,r=version+"/article_group/",i={title:e,body:t,img:imgData,date_edited:firebase.database.ServerValue.TIMESTAMP,uid:a,slug_name:e.replace(/\s/g,"-")},o=firebase.database().ref(r+"article").push().key,c={};return c[r+"article/"+o]=i,c[r+"article_list/"+o]={published:firebase.database.ServerValue.TIMESTAMP},firebase.database().ref().update(c).then(function(){alert("Added "+e)}).catch(function(e){console.log(e),alert(e.message)})}alert("You must be signed in to post")});